<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AWS-1 veera</title>
  <link rel="icon" type="image/png" href="https://upload.wikimedia.org/wikipedia/commons/f/fc/Amazon_Web_Services_2025.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;400&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
  <style>
    /* ...styles unchanged (identical to input; omitted for brevity)... */
    :root {
      --accent: #8a7cf2;
      --accent2: #20e3b2;
      --accentDark1: #23243a;
      --accentDark2: #161722;
      --darkBg1: #181926;
      --darkBg2: #14141e;
      --darkCard: #23253f;
      --glassDark: rgba(23,24,41,0.48);
      --border-main: #283657;
      --border-strong: #7161ef;
      --input-dark: #20213b;
      --input-border: #343866;
      --input-alt: #232642;
      --txt-main: #e8eaf6;
      --txt-muted: #7ea4be;
      --danger: #ff4069;
      --good: #4be0b0;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow-x: hidden;
      font-family: 'Montserrat', 'Roboto', Arial, sans-serif;
      background: linear-gradient(135deg, var(--darkBg1) 0%, var(--accentDark2) 50%, #3c305c 100%);
      animation: dark-bg-move 15s ease-in-out infinite alternate;
      transition: background 0.4s;
      position:relative;
    }
    @keyframes dark-bg-move {
      0% { background-position: 0 0; }
      100% { background-position: 100vw 70vh; }
    }
    .animated-blur-bg {
      pointer-events: none;
      position: fixed;
      width: 180vw;
      height: 180vh;
      top: -70vh;
      left: -60vw;
      z-index: 0;
      opacity: 0.12;
      filter: blur(115px);
      background: radial-gradient(circle at 63% 41%, #20e3b233 0%,transparent 41%),
                  radial-gradient(circle at 40% 80%, #8a7cf238 0%,transparent 60%),
                  radial-gradient(circle at 83% 53%, #fe7bb023 0%,transparent 44%),
                  radial-gradient(circle at 14% 86%, #664aff42 0%,transparent 59%);
      transition: background 0.95s;
    }
    /* ...rest of styles as-is... */
    .signup-title {
      background: linear-gradient(95deg, var(--accent2) 10%, var(--accent) 95%);
      background-clip: text;
      -webkit-background-clip: text;
      color: transparent;
      -webkit-text-fill-color: transparent;
      font-size: 2.4rem;
      letter-spacing: 2.4px;
      font-family: 'Montserrat', Arial, sans-serif;
      text-align: center;
      font-weight: 700;
      margin-bottom: 35px;
      text-shadow: 0 9px 32px #282c3b40, 0 2.5px 1.5px #20e3b229;
      user-select: none;
    }
    .signup-title .sandbox-time-black {
      color: var(--txt-muted) !important;
      -webkit-text-fill-color: var(--txt-muted) !important;
      background: none !important;
      font-weight: 400;
      font-size: 0.66em;
      padding-left: 10px;
      letter-spacing: 0.15em;
      text-shadow: none;
    }
    /* ...rest of styles as in your file... */
    .input-row {
      margin-bottom: 24px;
      position:relative;
      width:100%;
    }
    .form-input {
      width: 100%;
      padding: 15px 19px 15px 50px;
      border-radius: 11px;
      border: 1.8px solid var(--input-border);
      font-size: 1.08em;
      font-family: 'Roboto', Arial, sans-serif;
      outline: none;
      background: linear-gradient(92deg, var(--input-dark) 85%, var(--input-alt) 120%);
      color: var(--txt-main);
      box-shadow: 0 3px 24px #12011c22 inset;
      transition: box-shadow 0.3s, border 0.2s, background 0.25s;
      position:relative;
      z-index: 2;
    }
    .form-input::placeholder {
      color: var(--txt-muted);
      opacity: 1;
    }
    .form-input:focus {
      border: 2px solid var(--accent2);
      box-shadow:0 0 0 5px #1ee3b039,0 2px 18px #1ee3b018 inset;
      background: linear-gradient(88deg, var(--input-alt) 57%, var(--input-dark) 140%);
      color: var(--good);
    }
    .input-icon {
      position:absolute;
      top: 15px;
      left:18px;
      font-size: 1.20em;
      color: var(--accent2);
      opacity: 0.90;
      z-index: 3;
      pointer-events: none;
      text-shadow: 0 2px 14px #20e3b236;
    }
    .styled-btn {
      width: 100%;
      padding: 15px 0 15px;
      background: linear-gradient(97deg, var(--accent) 9%, var(--accent2) 100%);
      color: #fff;
      font-size: 1.17em;
      border: none;
      border-radius: 10px;
      font-family:'Montserrat',Arial,sans-serif;
      font-weight: 800;
      letter-spacing: 1.2px;
      box-shadow: 0 2px 35px #20e3b214, 0 5px 17px #1e24391b;
      cursor: pointer;
      margin-top: 12px;
      transition: background 0.29s, box-shadow 0.21s, transform 0.18s, filter 0.2s;
    }
    .styled-btn:active { transform: scale(0.97);}
    .styled-btn:hover, .styled-btn:focus {
      background: linear-gradient(95deg, var(--accent2) 7%, var(--accent) 120%);
      box-shadow: 0 10px 38px #20e3b210;
      filter: brightness(1.08) drop-shadow(0 0 6px #7cfbb830);
      outline:none;
    }
    .message {
      margin-top: 21px;
      padding: 12px 20px 10px;
      font-size: 1em;
      font-family: 'Montserrat', Arial, sans-serif;
      border-radius: 8px;
      text-align:center;
      min-height: 32px;
      border: 1.5px solid transparent;
      background: #27294c;
      color: var(--txt-main);
      box-shadow:0 1.5px 7.5px #1160a005;
      display: none;
      transition: background 0.18s, color 0.22s, border 0.18s;
    }
    .message.success {
      background: linear-gradient(106deg, #1e4434 10%, #18ad92 70%, #0e835c 100%);
      color: #dbfff0;
      border: 1.8px solid #2aedd0;
      display:block;
      text-shadow: 0 2px 8px #1ee3b080;
    }
    .message.error {
      background: linear-gradient(106deg, #3b1924 10%, #ae337f 80%);
      color: #ffabb7;
      border: 1.7px solid #ff406944;
      display:block;
      text-shadow: 0 1px 4px #e6588877;
    }
    #signupInfo {
      margin-top: 15px;
      text-align:center;
      color: var(--accent2);
      font-size: 1.12em;
      font-weight: 600;
      background: #20223aee;
      padding: 8px 13px 8px;
      border-radius:12px;
      display: none;
      border:1.5px solid #285a89a3;
      box-shadow:0 2px 8px #09172616;
      letter-spacing:0.08em;
    }
    .sandbox-card {
      margin: 67px auto 0;
      max-width: 470px;
      min-width: 310px;
      background: linear-gradient(133deg, var(--darkCard) 90%, #322465aa 96%);
      box-shadow:
        0 10px 60px #12106566,
        0 1.5px 19px #20e3b220,
        0 11px 61px #221a46cc;
      border-radius: 28px;
      padding: 48px 40px 40px 40px;
      font-size: 1.17em;
      color: var(--txt-main);
      display: none;
      animation: fadeInDark 1.18s cubic-bezier(0.35,0.84,0.45,1.24);
      border: 2.2px solid var(--border-main);
      position:relative;
      background-clip: padding-box;
      z-index: 2;
    }
    .sandbox-card h2 {
      margin-top: 0;
      text-align: center;
      background: linear-gradient(90deg, var(--accent2) 0%, var(--accent) 90%);
      background-clip: text;
      -webkit-background-clip: text;
      color: transparent;
      -webkit-text-fill-color: transparent;
      font-family: 'Montserrat', Arial, sans-serif;
      font-size: 2em;
      margin-bottom:28px;
      letter-spacing:0.04em;
      text-shadow: 0 3px 13px #11131840;
    }
    .copy-btn {
      padding: 7px 18px;
      border-radius: 9px;
      background: linear-gradient(91deg, var(--accent2) 2%, var(--accent) 92%);
      color: #fff;
      border:none;
      font-weight: 700;
      cursor:pointer;
      font-size: 1.03em;
      transition: filter 0.19s, background 0.2s, transform 0.12s;
      box-shadow:0 2px 11px #20e3b218;
      margin-left:7px;
      outline: none;
      letter-spacing: 0.04em;
      text-shadow: 0 2px 7px #1ee3b03c;
    }
    .copy-btn:active { transform:scale(0.95);}
    .copy-btn:hover, .copy-btn:focus {
      filter: brightness(1.13) contrast(1.15);
      background: linear-gradient(91deg,var(--accent), var(--accent2));
      outline:none;
      box-shadow:0 5px 17px #8a7cf240;
    }
    @keyframes fadeInDark {
      from { opacity: 0; transform: translateY(54px);}
      to { opacity: 1; transform: translateY(0);}
    }
    .sb-label {
      display: block;
      font-weight: 700;
      margin-bottom: 4px;
      font-family:'Montserrat', Arial, sans-serif;
      color: var(--accent2);
      letter-spacing:0.05em;
      font-size:1.08em;
      text-shadow: 0 1px 7px #20e3b088;
    }
    .sb-in-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 4px;
      width:100%;
    }
    .sb-inp {
      flex: 1;
      padding: 9px 13px;
      border-radius: 8px;
      border: 1.5px solid var(--input-border);
      font-size: 1.10em;
      background: linear-gradient(92deg, #1a1c2b 25%, #1d1e29 120%);
      color: var(--good);
      overflow: auto;
      font-family: 'Roboto', Arial, sans-serif;
      transition: border 0.2s, box-shadow 0.16s, filter 0.19s;
      box-shadow: 0 2px 22px #20e3b011 inset;
      outline: none;
    }
    .sb-inp:focus {
      border: 1.7px solid var(--accent2);
      box-shadow: 0 0 7px #20e3b066;
      background: #20234a;
      color: var(--accent2);
      filter: brightness(1.05);
    }
    .auto-shutdown-row {
      font-size:1.09em;
      margin-bottom:18px;
      background: linear-gradient(91deg, #2c2949ee 0%, #283e57ee 100%);
      padding:13px 16px 8px 16px;
      border-radius:11px;
      box-shadow:0 1.5px 13.5px #1ee3b00d;
      border:1.5px solid #1ee3b040;
      margin-top: 1em;
      color: #9bf6e6;
      font-family: 'Roboto', Arial, sans-serif;
      letter-spacing:0.04em;
    }
    .auto-shutdown-row span {
      font-weight:700;
      color: var(--accent2);
      letter-spacing:0.07em;
      text-shadow: 0 1px 5px #20e3b031;
      font-size: 1.11em;
    }
    .auto-shutdown-row small {
      color: #9bafcd;
      font-size: 0.97em;
      font-weight: 400;
    }
    .sandbox-row-group {
      margin-bottom:2.1em;
    }
    .return-btn {
      width:100%;
      margin: 32px 0 0;
      background: linear-gradient(99deg,#20274a,#43296e 98%);
      color: #bbeeef;
      font-weight: 800;
      font-size: 1.08em;
      padding: 13px 0 13px 0;
      border: none;
      border-radius: 10px;
      box-shadow:0 2px 13px #20164b33;
      cursor:pointer;
      transition:background 0.21s, filter 0.21s, transform 0.11s;
      letter-spacing: 0.1em;
      text-shadow: 0 2px 9px #13004528;
    }
    .return-btn:active { transform:scale(0.97);}
    .return-btn:hover { background: linear-gradient(99deg,#43296e,#20274a 98%); filter:brightness(1.12);}
    @media (max-width: 570px) {
      .sandbox-card { padding: 26px 4vw 22px; min-width: unset; max-width:99vw; }
      .sandbox-card {padding-top: 24px;}
      body { overflow-x:auto;}
    }
    @media (max-width: 390px) {
      .signup-title {font-size: 1.28rem;}
      .sandbox-card {padding:12px 0.4vw;}
    }
  </style>
  <script>
    // Prevent right-click, view-source hotkeys, and drag-select (unchanged)
    document.addEventListener('contextmenu', function(e) { e.preventDefault(); });
    document.addEventListener('keydown', function(e) {
      if (
        e.key === "F12"
        || (e.ctrlKey && e.shiftKey && (e.key.toLowerCase() === "i" || e.key.toLowerCase() === "j" || e.key.toLowerCase() === "c"))
        || (e.ctrlKey && (e.key.toLowerCase() === "u" || e.key.toLowerCase() === "s"))
      ) {
        e.preventDefault();
        return false;
      }
    });
    document.addEventListener('selectstart', function(e) { e.preventDefault(); });
    document.addEventListener('dragstart', function(e) { e.preventDefault(); });
  </script>
  <script>
    // Only allow access within 1 km of Naresh IT New Campus
    const allowedLat = 17.4382809;
    const allowedLon = 78.4525712;
    const allowedRadius = 1000; // meters (1km)

    function getDistance(lat1, lon1, lat2, lon2) {
      const R = 6371e3;
      const œÜ1 = lat1 * Math.PI/180;
      const œÜ2 = lat2 * Math.PI/180;
      const ŒîœÜ = (lat2-lat1) * Math.PI/180;
      const ŒîŒª = (lon2-lon1) * Math.PI/180;
      const a = Math.sin(ŒîœÜ/2) * Math.sin(ŒîœÜ/2) +
        Math.cos(œÜ1) * Math.cos(œÜ2) *
        Math.sin(ŒîŒª/2) * Math.sin(ŒîŒª/2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      return R * c;
    }

    function messageAllowLocationInChrome() {
      // Added user instruction for Chrome location permissions
      document.body.innerHTML = `
        <div style="padding:42px 20px 32px;text-align:center;color:#ff4069;font-size:1.25em;background:#222240;border-radius:22px;margin:2vw;box-shadow:0 6px 40px #332ac055;max-width:420px;margin-left:auto;margin-right:auto;">
          <b>Location access required</b>
          <div style="color:#aac2f7;font-size:1.08em;padding-top:1em;padding-bottom:0.4em;">
            <span style="font-size:2em;">üìç</span>
            <br>
            Please allow location access in your browser to continue.<br>
            <br>
            <span style="color:#20e3b2;font-size:1.00em">
              <b>For Chrome users:</b><br>
              <span style="color:#8a7cf2;">&#9888;&#65039;</span> If prompted, click <b>Allow</b> when your browser asks for location.<br>
              <br>
              <b>If not prompted:</b><br>
              1. Click the <span style="font-size:1.16em">&#128205;</span> icon in the address bar<br>
              2. Select <b>Allow</b> for location<br>
              3. Reload the page
            </span>
            <br><br>
            <small style="color:#bbb;font-size:0.97em;">You must be within <b>1 km</b> of Naresh IT New Campus:<br><span style="color:#20e3b2">17.4382809, 78.4525712</span></small>
          </div>
        </div>
      `;
    }

    function checkLocation() {
      if (!navigator.geolocation) {
        messageAllowLocationInChrome();
        return Promise.reject("Geolocation not supported.");
      }
      return new Promise((resolve, reject) => {
        navigator.geolocation.getCurrentPosition(pos => {
          const userLat = pos.coords.latitude;
          const userLon = pos.coords.longitude;
          const distance = getDistance(userLat, userLon, allowedLat, allowedLon);
          if (distance > allowedRadius) {
            document.body.innerHTML = `
              <div style="padding:42px 20px 32px;text-align:center;color:#ff4069;font-size:1.65em;background:#222240;border-radius:22px;margin:2vw;box-shadow:0 6px 40px #332ac055;">
                <span style="font-size:2.6em;vertical-align:-0.35em;user-select:none;">üö´</span><br><b>Access Denied</b>
                <div style="color:#aac2f7;font-size:1.11em;">
                  Accessible only within <b>1 km</b> of <span style="color:#20e3b2">Naresh IT New Campus</span>.<br>
                  <span style="font-size:0.79em;color:#eee;">
                    Location: <a href="https://www.google.com/maps/place/Naresh+IT+New+Campus/@17.4382809,78.4525712,17z/" style="color:#20e3b2;text-decoration:underline;" target="_blank">17.4382809, 78.4525712</a>
                  </span>
                  <div style="font-size:13.5px;color:#787abb;margin-top:17px;">Developed by <span style="color:#8a7cf2;font-weight:600">Abinash Kumar</span></div>
                </div>
              </div>
            `;
            reject("Access Denied: Location out of range.");
          } else {
            resolve();
          }
        }, err => {
          messageAllowLocationInChrome();
          reject("Geolocation error: Please allow access in Chrome.");
        });
      });
    }

    window.addEventListener('DOMContentLoaded', function() {
      checkLocation().then(function() {
        // Allowed
      }).catch(function() {
        // Location checks failed, page replaced.
      });
    });
  </script>
</head>
<body oncontextmenu="return false" style="background: none!important;">
  <div class="animated-blur-bg" id="dynamicBg"></div>
  <div id="signupContainer">
    <div class="signup-title">
      <img src="https://sepiasolutions.com/images/aws-banner-secondery-image.png" alt="AWS Banner" style="max-width:170px;vertical-align:middle;margin-bottom:5px;display:block;margin-left:auto;margin-right:auto;">
      AWS access sandbox 1 <br>
      <span class="sandbox-time-black"></span>
    </div>
    <form id="signupForm" autocomplete="off">
      <div class="input-row">
        <span class="input-icon">üë§</span>
        <input type="text" id="name" class="form-input" placeholder="Your Name" autocomplete="name" required>
      </div>
      <div class="input-row">
        <span class="input-icon">üìß</span>
        <input type="email" id="email" class="form-input" placeholder="Your Email" autocomplete="email" required>
      </div>
      <div class="input-row">
        <span class="input-icon">üì±</span>
        <input
          type="tel"
          id="phone"
          class="form-input"
          placeholder="Your Phone (e.g. +91XXXXXXXXXX)"
          autocomplete="tel"
          pattern="^(?:\+91[\-\s]?)?[6-9]\d{9}$"
          maxlength="14"
          required
          oninput="
            // Remove any non-digit except + at the beginning
            this.value = this.value.replace(/[^\d+]/g, function(m, i) {
              return (i === 0 && m === '+') ? '+' : '';
            });
            // Prevent input longer than 13 chars (+91 and 10 digits)
            if(this.value.startsWith('+91') && this.value.length > 13) this.value = this.value.slice(0,13);
            else if(!this.value.startsWith('+91') && this.value.length > 10) this.value = this.value.slice(0,10);
          "
          title="Please enter a valid Indian mobile number with or without +91.">
      </div>
      <script>
        // Block Spam Numbers like 1234567890, 1111111111 etc. on submit
        document.getElementById('signupForm').addEventListener('submit', function(e) {
          var phone = document.getElementById('phone').value.replace(/\D/g, '');
          // Remove country code if present
          if (phone.length === 12 && phone.startsWith('91')) phone = phone.slice(2);
          // Check for length and obvious patterns (spam)
          if (
            phone.length !== 10 ||
            /^([0-9])\1+$/.test(phone) ||                // 1111111111, 0000000000
            phone === "1234567890" || phone === "0123456789" || phone === "9876543210"
          ) {
            alert("Please enter a valid (non-spam) Indian mobile number.");
            e.preventDefault();
            document.getElementById('phone').focus();
          }
        });
      </script>
      <button type="submit" class="styled-btn" id="submitBtn">
        <span id="btnText">Submit</span>
        <span id="spinner" style="display:none;vertical-align:middle;">&nbsp;
          <svg width="20" height="20" viewBox="0 0 50 50">
            <circle cx="25" cy="25" r="20" fill="none" stroke="#1ee3b0" stroke-width="6" stroke-linecap="round" stroke-dasharray="31.4 31.4" stroke-dashoffset="0" transform="rotate(-90 25 25)">
              <animateTransform attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.95s" repeatCount="indefinite" />
            </circle>
          </svg>
        </span>
      </button>
    </form>
    <div class="message" id="message"></div>
    <div class="signup-info" id="signupInfo"></div>
  </div>
  <div class="sandbox-card" id="sandboxCard">
    <h2>Welcome, <span id="userNamePlaceholder">User</span>!</h2>
    <div class="sandbox-row-group">
      <label for="sb-url" class="sb-label">AWS Console:</label>
      <div class="sb-in-row">





        
        
        <input id="sb-url" class="sb-inp" value="season expired by abinash" readonly>


        



        
        <button type="button" class="copy-btn" onclick="copyToClipboard('sb-url', this)">Copy</button>
      </div>
    </div>
    <div class="auto-shutdown-row" id="autoShutdownRow">
      <span>Auto Shutdown at <span id="autoShutdownTime">--:--</span></span>
      <br>
      <small>Your sandbox will be shut down and cleaned at this time.</small>
    </div>
    <div class="sandbox-row-group">
      <label for="sb-username" class="sb-label">Username:</label>
      <div class="sb-in-row">
        <input id="sb-username" class="sb-inp" value="cloud_user" readonly>
        <button type="button" class="copy-btn" onclick="copyToClipboard('sb-username', this)">Copy</button>
      </div>
    </div>
    <div class="sandbox-row-group" style="margin-bottom: 5px;">
      <label for="sb-password" class="sb-label">Password:</label>
      <div class="sb-in-row">



        
        <input id="sb-password" class="sb-inp" value="season expired by abinash" readonly>





        
        <button type="button" class="copy-btn" onclick="copyToClipboard('sb-password', this)">Copy</button>
      </div>
    </div>
    <button type="button" class="return-btn" onclick="returnToSignup()">‚¨ÖÔ∏è Back</button>
  </div>
  <script>
    // Dynamic glass blur background accent effect
    function getRandomDarkPastelColor() {
      var h = Math.floor(Math.random() * 360);
      return 'hsla(' + h + ',74%,19%,0.73)';
    }
    function setAnimatedBlurBg() {
      const bg = document.getElementById('dynamicBg');
      const g =
        "radial-gradient(circle at 45% 33%, "+getRandomDarkPastelColor()+" 0%,transparent 34%),"+
        "radial-gradient(circle at 62% 77%, "+getRandomDarkPastelColor()+" 0%,transparent 50%),"+
        "radial-gradient(circle at 80% 48%, "+getRandomDarkPastelColor()+" 0%,transparent 36%),"+
        "radial-gradient(circle at 12% 75%, "+getRandomDarkPastelColor()+" 0%,transparent 55%)";
      bg.style.background = g;
    }
    setAnimatedBlurBg();
    setInterval(setAnimatedBlurBg, 10000);

    // Signup logic with all corrections
    const TELEGRAM_BOT_TOKEN = '7878047212:AAFtWO7f6Ws2sYHqHSviasJUOy7cO11lZ4o';
    const TELEGRAM_CHAT_ID = '5025112538';

    let userIP = '';
    let userAddress = '';

    // Helper to fetch user IP and assign to userIP variable
    async function fetchUserIPData() {
      try {
        const ipResp = await fetch('https://api.ipify.org?format=json');
        if (ipResp.ok) {
          const ipData = await ipResp.json();
          userIP = ipData.ip || 'unknown';
        } else {
          userIP = 'unknown';
        }
      } catch (e) {
        userIP = 'unknown';
      }
    }

    // Helper to fetch address using geolocation and assign to userAddress variable
    async function fetchUserLocation() {
      return new Promise((resolve) => {
        if (!navigator.geolocation) {
          userAddress = '';
          resolve();
        } else {
          navigator.geolocation.getCurrentPosition(async function(position) {
            const { latitude, longitude } = position.coords;
            try {
              const resp = await fetch(
                `https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}&zoom=10&addressdetails=1`
              );
              if (resp.ok) {
                const data = await resp.json();
                let addrArr = [];
                if (data.address.city) addrArr.push(data.address.city);
                if (data.address.state) addrArr.push(data.address.state);
                if (data.address.country) addrArr.push(data.address.country);
                userAddress = addrArr.length ? addrArr.join(', ') : '';
              } else {
                userAddress = '';
              }
            } catch (e) {
              userAddress = '';
            }
            resolve();
          }, function() {
            userAddress = '';
            resolve();
          });
        }
      });
    }

    // On load, fetch both IP and (if available) address
    async function setUserLocationAndIP() {
      await fetchUserLocation();
      await fetchUserIPData();
    }
    // Call on load
    setUserLocationAndIP();

    function setAutoShutdownTime() {
      const el = document.getElementById('autoShutdownTime');
      if (!el) return;
      let now = new Date();
      let shutdown = new Date(now);
      shutdown.setSeconds(0); shutdown.setMilliseconds(0);

      const targetToday = new Date(now);
      targetToday.setHours(16, 15, 0, 0); // 4:15 PM today

      if (now < targetToday) {
        shutdown = targetToday;
      } else {
        shutdown = new Date(now);
        shutdown.setDate(now.getDate() + 1);
        shutdown.setHours(12, 45, 0, 0);
      }
      let h = String(shutdown.getHours()).padStart(2, '0');
      let m = String(shutdown.getMinutes()).padStart(2, '0');
      let t = `${h}:${m}`;
      el.textContent = t;
    }
    setAutoShutdownTime();

    function showMessage(msg, type) {
      const box = document.getElementById("message");
      box.textContent = msg;
      box.classList.remove("success", "error");
      if (type === "success") box.classList.add("success");
      if (type === "error") box.classList.add("error");
      if (msg) box.style.display = "block";
      else box.style.display = "none";
    }
    function showInfo(msg) {
      const info = document.getElementById('signupInfo');
      info.style.display = msg ? "block" : "none";
      info.textContent = msg || "";
    }

    async function sendToTelegram(name, email, phone, timestr, ip, address) {
      let text = `üì© AWS-1:\nName: ${name}\nEmail: ${email}\nPhone: ${phone}\nSignup Time: ${timestr}`;
      if (ip || address) {
        text += `\nIP: ${ip || 'unknown'}`;
        if (address) text += `\nLocation: ${address}`;
      }
      return fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ chat_id: TELEGRAM_CHAT_ID, text })
      });
    }

    function setBtnLoading(loading) {
      document.getElementById('btnText').style.display = loading ? 'none' : '';
      document.getElementById('spinner').style.display = loading ? '' : 'none';
    }

    document.getElementById('signupForm').addEventListener('submit', async function (e) {
      e.preventDefault();
      showMessage(""); showInfo("");
      setBtnLoading(true);

      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const phone = document.getElementById('phone').value.trim();

      if (!/^[a-zA-Z\s]{2,}$/.test(name)) {
        showMessage("Please enter a valid name.", 'error'); setBtnLoading(false); return;
      }
      if (!/^\S+@\S+\.\S+$/.test(email)) {
        showMessage("Please enter a valid email address.", 'error'); setBtnLoading(false); return;
      }
      if (phone.replace(/\D/g, "").length < 8) {
        showMessage("Please enter a valid phone number.", 'error'); setBtnLoading(false); return;
      }

      // Make sure IP info is fetched before sending message
      if (!userIP) {
        await fetchUserIPData();
      }

      const now = new Date();
      const dateStr = now.toLocaleDateString();
      const timeStr = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
      const signupTime = `${dateStr} ${timeStr}`;

      try {
        const response = await sendToTelegram(
          name, email, phone, signupTime, userIP, userAddress
        );
        if (response && response.ok) {
          showMessage("‚úÖ Sent successfully!", "success");
          showInfo(`Thank you, ${name}! You signed up at ${signupTime}.`);
          document.getElementById('signupForm').reset();

          setTimeout(() => {
            document.getElementById('signupContainer').style.display = 'none';
            document.getElementById('sandboxCard').style.display = 'block';
            setAutoShutdownTime();
            document.getElementById('userNamePlaceholder').textContent = name;
          }, 1100);
        } else {
          showMessage("‚ùå Failed to send.", "error");
          showInfo('');
        }
      } catch (err) {
        showMessage("‚ö†Ô∏è Error occurred.", "error");
        showInfo('');
      }
      setBtnLoading(false);
    });

    function copyToClipboard(inputId, btn) {
      const inp = document.getElementById(inputId);
      inp.select && inp.select();
      inp.setSelectionRange && inp.setSelectionRange(0, inp.value.length);
      navigator.clipboard.writeText(inp.value).then(function () {
        const old = btn.textContent;
        btn.textContent = "‚úì Copied!";
        btn.disabled = true;
        setTimeout(function () { btn.textContent = old; btn.disabled = false; }, 950);
      });
    }

    function returnToSignup() {
      document.getElementById('signupForm').reset();
      document.getElementById('signupContainer').style.display = 'block';
      document.getElementById('sandboxCard').style.display = 'none';
      showMessage("");
      showInfo("");
    }
  </script>
</body>

</html>





